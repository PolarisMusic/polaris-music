# Blockchain Configuration
CHAIN_ID=aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906
RPC_URL=https://eos.greymass.com
CONTRACT_ACCOUNT=polaris

# Chain Ingestion Source (T6)
# Options: substreams (primary, recommended) | ship (NOT IMPLEMENTED - will fail)
# CRITICAL: SHiP mode is non-functional (drops binary messages, requires ABI deserialization)
# Use CHAIN_SOURCE=substreams for production and development
CHAIN_SOURCE=substreams

# SHiP (State History Plugin) Configuration - Only used if CHAIN_SOURCE=ship
# WARNING: SHiP binary deserialization is NOT implemented
# Setting CHAIN_SOURCE=ship will cause immediate startup failure
# If SHiP support is required, see backend/src/indexer/shipEventSource.js for implementation notes
# Recommended libraries: eosio-ship-reader, @greymass/eosio
SHIP_URL=ws://localhost:8080
START_BLOCK=0
END_BLOCK=0xffffffff

# Neo4j Graph Database
GRAPH_URI=bolt://localhost:7687
GRAPH_USER=neo4j
GRAPH_PASSWORD=polarisdev

# Neo4j Schema Management
# GRAPH_INIT_SCHEMA: Initialize database schema (constraints, indexes) on startup
#   - true: Run initializeSchema() during server start (recommended for dev/staging)
#   - false: Skip schema initialization (use for prod if managing schema separately)
#   - Default: true (runs unless explicitly set to 'false')
GRAPH_INIT_SCHEMA=true

# GRAPH_RUN_MIGRATIONS: Run pending database migrations on startup
#   - true: Automatically run migrations that haven't been applied yet
#   - false: Skip migrations (manual migration required)
#   - Default: false (must be explicitly enabled for safety)
#   - WARNING: Only enable in controlled environments; migrations can modify data
#   - Current migrations:
#     001-unify-id-property: Backfills universal 'id' from entity-specific IDs
#     002-normalize-status-values: Converts 'canonical'/'provisional' â†’ 'ACTIVE'/'PROVISIONAL'
#   - See: backend/docs/migrations/ for runbooks
GRAPH_RUN_MIGRATIONS=false

# Redis Cache
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=polarisdev

# IPFS Storage
# Default: Single node (minimal mode) - easy deployment
# IPFS_URLS: Comma-separated list of IPFS API endpoints
#   - Single node: IPFS_URLS=http://localhost:5001
#   - Multi-node (best-effort redundancy): IPFS_URLS=http://localhost:5001,http://localhost:5002
#   - First node is primary (for writes), others are secondary (replication)
#   - Docker Compose with ipfs2: IPFS_URLS=http://ipfs:5001,http://ipfs2:5001
IPFS_URLS=http://localhost:5001

# IPFS_URL: Single IPFS node (DEPRECATED - use IPFS_URLS instead)
# IPFS_URL=http://localhost:5001

# External Pinning Provider (optional, best-effort)
# PIN_PROVIDER: none|pinata|web3storage|custom (default: none)
#   - none: No external pinning (local IPFS nodes only)
#   - pinata: Pin to Pinata.cloud (requires PIN_PROVIDER_TOKEN)
#   - web3storage: Pin to Web3.Storage (requires PIN_PROVIDER_TOKEN)
#   - custom: Pin to custom endpoint (requires PIN_PROVIDER_ENDPOINT)
PIN_PROVIDER=none

# PIN_PROVIDER_TOKEN: API token/JWT for pinning provider
#   - Required for pinata and web3storage
#   - Optional for custom (if authentication needed)
# PIN_PROVIDER_TOKEN=

# PIN_PROVIDER_ENDPOINT: Custom pinning endpoint URL
#   - Only required if PIN_PROVIDER=custom
#   - Expects POST ${endpoint} with JSON body: { cid: "bafy..." }
# PIN_PROVIDER_ENDPOINT=

# PIN_PROVIDER_TIMEOUT_MS: Timeout for pinning requests (milliseconds)
#   - Default: 8000 (8 seconds)
#   - Pinning failures do NOT fail event creation (best-effort)
PIN_PROVIDER_TIMEOUT_MS=8000

# S3/MinIO Storage
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=polaris
S3_SECRET_KEY=polarisdev123
S3_BUCKET=polaris-events
S3_REGION=us-east-1

# API Configuration
NODE_ENV=development
# PORT=3001 for local development (Docker uses 3000)
PORT=3001
# CORS_ORIGIN supports comma-separated list for multiple dev origins
# Example: http://localhost:5173,http://localhost:4173
CORS_ORIGIN=http://localhost:5173
LOG_LEVEL=debug

# Security: Write Endpoint Authentication
# INGEST_API_KEY: Shared secret required in X-API-Key header for write endpoints.
#   - When set: POST /api/events/create, /api/events/prepare, and
#     /api/ingest/anchored-event all require X-API-Key: <this value>
#   - When unset: Write endpoints are open (local dev only!)
#   - In production: ALWAYS set this to a strong random value (e.g., openssl rand -hex 32)
#   - Rate limiting (30 req/min per IP) is always active regardless of API key
# INGEST_API_KEY=

# Security: Signature Verification
# ALLOW_UNSIGNED_EVENTS: Bypass cryptographic signature verification for events
#   - WARNING: DO NOT set to 'true' in production - undermines verifiability guarantees
#   - Only use for isolated testing with mock data (e.g., unit tests)
#   - Default: undefined (strict verification enforced)
#   - Tests automatically set this to 'true' via test/setup.js
# ALLOW_UNSIGNED_EVENTS=true

# Security: Account Authorization
# REQUIRE_ACCOUNT_AUTH: Verify that event signing key is authorized for the anchoring account
#   - true (default): Verify public key is authorized for account@permission via RPC
#   - false: Skip account authorization check (smoke tests/dev only)
#   - WARNING: Default is true (secure). Only set to 'false' for smoke tests.
#   - In production, this ensures only authorized keys can create events for accounts
# REQUIRE_ACCOUNT_AUTH=true

# Development: Server-side Event Signing (DEV/TEST ONLY)
# DEV_SIGNER_PRIVATE_KEY: EOSIO private key for dev-only server-side signing
#   - WARNING: NEVER use in production (NODE_ENV=production)
#   - Only enabled when this env var is set AND NODE_ENV !== 'production'
#   - Enables POST /api/events/dev-sign endpoint for smoke tests
#   - Example test key (DO NOT use real keys!): 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3
#   - In production, signing must happen client-side with user wallets
# DEV_SIGNER_PRIVATE_KEY=
